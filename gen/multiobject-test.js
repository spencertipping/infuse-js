// Infuse multiobjects.
// See also the [Infuse multiobject source](multiobject-src.md).

// Just like objects, but each key maps to multiple values:

var o = $i.multiobject();

infuse.assert_equal((o.size()                       ), (0));
infuse.assert_equal((o.push(1, 'foo')               ), (o));
infuse.assert_equal((o.push(2, 'foo')               ), (o));
infuse.assert_equal((o.push(1, 'bar')               ), (o));

infuse.assert_equal((o.tos()                        ), ('I{bar::I[1], foo::I[1, 2]}'));
infuse.assert_equal((o.get('foo').tos()             ), ('I[1, 2]'));
infuse.assert_equal((o.get('bar').tos()             ), ('I[1]'));
infuse.assert_equal((o.size()                       ), (3));

var i = o.inverse();
infuse.assert_equal((i.tos()                        ), ('#{1::I[foo, bar], 2::I[foo]}'));
infuse.assert_equal((i.get('1').tos()               ), ('I[foo, bar]'));
infuse.assert_equal((i.size()                       ), (3));

o.push(2, 'bif');
infuse.assert_equal((i.size()                       ), (4));
infuse.assert_equal((i.get('2').join(',')           ), ('foo,bif'));

// Multiobjects are generated when you `group` a collection. For example:

var xs = $i([1, 2, 3, 4, 5, 6]);
var grouped = xs.group('_ % 3');
var indexed = xs.index('_ % 3');

infuse.assert_equal((grouped.tos()                  ), ('#{0::I[3, 6], 1::I[1, 4], 2::I[2, 5]}'));
infuse.assert_equal((grouped.size()                 ), (6));
infuse.assert_equal((grouped.get('0').join(',')     ), ('3,6'));
infuse.assert_equal((grouped.get('1').join(',')     ), ('1,4'));

infuse.assert_equal((indexed.tos()                  ), ('#{0: 6, 1: 4, 2: 5}'));
infuse.assert_equal((indexed.size()                 ), (3));
infuse.assert_equal((indexed.get('0')               ), (6));
infuse.assert_equal((indexed.get('1')               ), (4));

// And like all other Infuse collections, multiobjects provide dynamic updating:

infuse.assert_equal((xs.push(7)                     ), (xs));
infuse.assert_equal((grouped.get('1').tos()         ), ('I[1, 4, 7]'));
infuse.assert_equal((grouped.size()                 ), (7));

// Generated by SDoc
